<!-- {{internal|json}}
{{external|json}} -->
<app-loader *ngIf="loader"></app-loader>
<div class="inner-container" *ngIf="!loader">
  <div class="wrapper">
    <div class="d-flex justify-content-end">
      <span class="icon-rejected" (click)="back()"></span>
    </div>
    <div class="row w-100">
      <div class="col-1 text-center backarrow">
        <mat-icon class="cursorPointer gray" (click)="back()">keyboard_backspace</mat-icon>
      </div>
      <div class="col-10 pl-0">
        <legend class="header">{{id ? 'Update Service Level Agreement' : 'Add New Service Level Agreement'}}</legend>
          <div class="formGroup mt-4 slaAccordion">
            <div class="row">
              <div class="col-lg-12 col-md-12 col-sm-12">
                <mat-accordion class="">
                    <mat-expansion-panel  #panel1 class="expansionPanelBorder mb-3">
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          {{labelName?.ServiceLevelAgreementDetails}}
                        </mat-panel-title>
                      </mat-expansion-panel-header>
                      <form [formGroup]="form">
                        <div class="row ServiceLevelAgreementDetails">
                          <div class="col-6">
                            <mat-form-field appearance="fill">
                              <mat-label> {{labelName?.Name}}</mat-label>
                              <input matInput formControlName="SLAName">
                              <mat-error *ngIf="f.SLAName.errors">
                                <ng-container *ngIf="f.SLAName.errors.required">
                                  Name is required
                                </ng-container>
                                <ng-container *ngIf="f.SLAName.errors.pattern">
                                  Name is invalid
                                </ng-container>
                                <ng-container *ngIf="f.SLAName.errors.maxLength">
                                  Name exceeds maxlength.
                                </ng-container>
                                <ng-container *ngIf="f.SLAName.errors.checknull1">
                                  Must be at least 3 characters long.
                                </ng-container>
                              </mat-error>
                            </mat-form-field>
                          </div>
                          <div class="col-6">
                            <mat-form-field appearance="fill">
                              <mat-label> {{labelName?.Description}}</mat-label>
                              <input matInput formControlName="SLADesc">
                              <mat-error *ngIf="f.SLADesc.errors">
                                <!-- <ng-container *ngIf="f.SLADesc.errors.required">
                                  Description is required
                                </ng-container> -->
                                <ng-container *ngIf="f.SLADesc.errors.pattern">
                                  Description is invalid
                                </ng-container>
                                <ng-container *ngIf="f.SLADesc.errors.maxlength">
                                  Cannot be beyond 300 characters.
                                </ng-container>
                                <ng-container *ngIf="f.SLADesc.errors.checknull1">
                                  Must be at least 3 characters long.
                                </ng-container>
                              </mat-error>
                            </mat-form-field>
                          </div>
                          <div class="" [ngClass]="productid == 10 ? 'col-4' : 'col-lg-3 col-md-6 col-6'">
                            <mat-form-field appearance="fill">
                              <mat-label> {{labelName?.Channel}}</mat-label>
                              <mat-select formControlName="ChannelId" (selectionChange)="channelChanged()">
                                <!-- <mat-select formControlName="ChannelId" (selectionChange)="getChannelSource()"></mat-select> -->
                                <!-- <mat-option *ngFor="let item of userChannelName" [value]="item.ChannelId">{{item.ChannelName}}</mat-option> -->



                                <mat-select-trigger *ngIf="form.controls?.ChannelId.value" class="d-flex align-items-center" >
                                  <ng-container *ngFor="let item2 of userChannelName">
                                    <ng-container *ngIf="form.controls?.ChannelId.value == item2.ChannelId">
                                      <span [innerHtml]="item2?.ChannelIcon"></span>
                                      <span>{{item2.ChannelName}}</span>
                                    </ng-container>
                                  </ng-container>
                                </mat-select-trigger>
                              <mat-option *ngFor="let data of userChannelName; let i = index" [value]="data.ChannelId">
                                  <span [innerHtml]="data?.ChannelIcon"></span>
                                  <span>{{data.ChannelName}}</span>
                                </mat-option>
                              </mat-select>
                              <mat-error *ngIf="f.ChannelId.errors">
                                <ng-container *ngIf="f.ChannelId.errors.required">Channel is required.
                                </ng-container>
                              </mat-error>
                            </mat-form-field>
                          </div>
                          <div class="" [ngClass]="productid == 10 ? 'col-4' : 'col-lg-3 col-md-6 col-6'">
                            <mat-form-field appearance="fill">
                              <mat-label> {{labelName?.ChannelSource}}</mat-label>
                              <mat-select formControlName="ChannelSourceId">
                                <mat-option *ngFor="let item of channelSourceId" matTooltip="{{item.ChannelSourceName}}" [value]="item.ChannelSourceId">{{item.ChannelSourceName}}</mat-option>
                              </mat-select>
                              <mat-error *ngIf="f.ChannelSourceId.errors">
                                <ng-container *ngIf="f.ChannelSourceId.errors.required">Channel source is required.
                                </ng-container>
                              </mat-error>
                            </mat-form-field>
                          </div>
                          <div class="" *ngIf="productid != 10" [ngClass]="productid == 10 ? 'col-4' : 'col-lg-3 col-md-6 col-6'">
                            <mat-form-field appearance="fill">
                              <mat-label> {{labelName?.RequestType}}</mat-label>
                              <mat-select formControlName="RequestType">
                                <mat-option *ngFor="let item of SlaRequestType" [value]="item.Key">{{item.Value}}</mat-option>
                              </mat-select>
                              <mat-error *ngIf="f.RequestType.errors">
                                <ng-container *ngIf="f.RequestType.errors.required">Request type is required.
                                </ng-container>
                              </mat-error>
                            </mat-form-field>
                          </div>
                          <div class="" [ngClass]="productid == 10 ? 'col-4' : 'col-lg-3 col-md-6 col-6'">
                            <mat-form-field appearance="fill">
                              <mat-label> {{labelName?.SLAType}}</mat-label>
                              <mat-select formControlName="SLAType" (selectionChange)="ChangedSLA();valueChanged();changeMainDropdown();responsetimetypeChanged()">
                                <mat-option *ngFor="let item of SLAType" matTooltip="{{item.Value}}" [value]="item.Key">{{item.Value}}</mat-option>
                              </mat-select>
                              <mat-error *ngIf="f.SLAType.errors">
                                <ng-container *ngIf="f.SLAType.errors.required">SLA type is required.
                                </ng-container>
                              </mat-error>
                            </mat-form-field>
                          </div>
                          <div class="col-lg-3 col-md-6 col-6" *ngIf="productid != 10">
                            <mat-form-field appearance="fill">
                              <mat-label> {{labelName?.Priority}}</mat-label>
                              <mat-select formControlName="SLAPriority">
                                <mat-option *ngFor="let item of dummyJson" [value]="item">{{item}}</mat-option>
                              </mat-select>
                              <mat-error *ngIf="f.SLAPriority.errors">
                                <ng-container *ngIf="f.SLAPriority.errors.required">Priority is required.
                                </ng-container>
                              </mat-error>
                            </mat-form-field>
                          </div>
                          <div class="col-lg-4 col-md-4 col-12 example-container inputText normal-dropdown">
                                <mat-form-field appearance="fill">
                                  <input matInput type="number" (keypress)="numericOnly($event)" min="1" (change)="valueChanged()" formControlName="ResponseTime" panelClass="normal-panel" class="example-right-align" placeholder="00">
                                  <span matPrefix>
                                    <ng-container *ngIf="!form.value.SLAType"> {{labelName?.SelectValue}}</ng-container>
                                    <ng-container *ngFor="let item of SLAType">
                                      <ng-container *ngIf="form.value.SLAType == item.Key">{{item.Value}}</ng-container>
                                    </ng-container>
                                  </span>
                                  <mat-select matSuffix  class="ml-2" placeholder="Min" formControlName="ResponseType" (selectionChange)="responsetimetypeChanged();returnValueType();valueChanged();">
                                    <mat-option *ngFor="let item of mainDurationDropDown" [value]="item.Key">{{item.Value}}</mat-option>
                                  </mat-select>
                                  <mat-error *ngIf="f.ResponseTime.errors">
                                    <ng-container *ngIf="f.ResponseTime.errors.required; else ResponseMin">
                                      <ng-container *ngIf="!form.value.SLAType">Select Value</ng-container>
                                      <ng-container *ngFor="let item of SLAType">
                                        <ng-container *ngIf="form.value.SLAType == item.Key">{{item.Value}}</ng-container>
                                      </ng-container> is required.</ng-container>
                                    <ng-template #ResponseMin >
                                      <ng-container *ngIf="f.ResponseTime.errors.min; else ResponseMax">
                                        <ng-container *ngIf="!form.value.SLAType">Select Value</ng-container>
                                        <ng-container *ngFor="let item of SLAType">
                                          <ng-container *ngIf="form.value.SLAType == item.Key">{{item.Value}}</ng-container>
                                        </ng-container> is min.</ng-container>
                                    </ng-template>
                                    <ng-template #ResponseMax >
                                      <ng-container *ngIf="f.ResponseTime.errors.max">                                    <ng-container *ngIf="!form.value.SLAType">Select Value</ng-container>
                                      <ng-container *ngFor="let item of SLAType">
                                        <ng-container *ngIf="form.value.SLAType == item.Key">{{item.Value}}</ng-container>
                                      </ng-container> is max.</ng-container>
                                    </ng-template>
                                  </mat-error>
                                </mat-form-field>
                          </div>
                          <div class="col-lg-3 col-md-3 col-12 pt-2">
                            <mat-slide-toggle labelPosition='before' formControlName="EnableBusinessHrs" color="primary" class="toggleBtn cursorPointer">
                              {{labelName?.BusinessHours}}
                            </mat-slide-toggle>
                          </div>
                        </div>
                      </form>
                    </mat-expansion-panel>
                    <form [formGroup]="form1">
                    <mat-expansion-panel  (opened)="!form.value.EnableReminder ? mapanel.close():''"
                      #mapanel="matExpansionPanel" class="expansionPanelBorder mb-3">
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          {{labelName?.Reminders}}
                        </mat-panel-title>
                        <mat-slide-toggle (click)="$event.stopPropagation();" [(ngModel)]="reminderToggleStatus" [ngModelOptions]="{standalone: true}" color="primary" class="toggleBtn"  (toggleChange)="toggleStatusCheck(1);!form.value.EnableReminder ? mapanel.close() : ''"></mat-slide-toggle>
                      </mat-expansion-panel-header>
                      <div class="p-3 mb-3 backgroundWhite">
                        <div class="row mb-3">
                          <div class="col-12">
                            {{form?.value['SLAType']}}  {{labelName?.Reminders}}
                            <!-- Response Time Reminders -->
                          </div>
                        </div>
                        <div  formArrayName="responsetimereminders" *ngFor="let item of form1.get('responsetimereminders')['controls']; let i = index; let first = first;let last = last">
                          <div class="row" [formGroupName]="i" [ngClass]="first ? '' : 'mt-3'">
                            <div class="col-lg-10 col-md-9 col-8">
                              <div class="row">
                                <div class="col-lg-3 col-md-6 col-12">
                                  <mat-form-field appearance="fill">
                                    <mat-label> {{labelName?.Field}}</mat-label>
                                    <mat-select formControlName="Field" disabled>
                                      <mat-option *ngFor="let item1 of SLAType" matTooltip="{{item1.Value}}" [value]="item1.Key">{{item1.Value}}</mat-option>
                                    </mat-select>
                                    <mat-error *ngIf="item.get('Field').errors">
                                      <ng-container *ngIf="item.get('Field').errors.required">Field is required.
                                      </ng-container>
                                    </mat-error>
                                  </mat-form-field>
                                </div>
                                <div class="col-lg-3 col-md-6 col-12">
                                  <mat-form-field appearance="fill">
                                    <mat-label> {{labelName?.Condition}}</mat-label>
                                    <mat-select formControlName="Condition">
                                      <mat-option *ngFor="let item1 of comparisonOperator" [value]="item1">{{item1}}</mat-option>
                                    </mat-select>
                                    <mat-error *ngIf="item.get('Condition').errors">
                                      <ng-container *ngIf="item.get('Condition').errors.required">Condition is required.
                                      </ng-container>
                                    </mat-error>
                                  </mat-form-field>
                                </div>
                                <div class="col-lg-3 col-md-6 col-12">
                                  <mat-form-field appearance="fill">
                                    <mat-label> {{labelName?.Type}}</mat-label>
                                    <mat-select formControlName="ValueType" (selectionChange)="conditionValueTypeChanged('responsetimereminders',i)">
                                      <mat-option *ngFor="let item1 of valueTypeArray" [value]="item1.Key">{{item1.Value}}</mat-option>
                                    </mat-select>
                                    <mat-error *ngIf="item.get('ValueType').errors">
                                      <ng-container *ngIf="item.get('ValueType').errors.required">Value is required.
                                      </ng-container>
                                    </mat-error>
                                  </mat-form-field>
                                </div>
                                <div class="col-lg-3 col-md-6 col-12">
                                  <mat-form-field appearance="fill">
                                    <mat-label> {{labelName?.Value}}</mat-label>
                                    <mat-select formControlName="Value" (selectionChange)="conditionValueChanged('responsetimereminders',i)" [disabled]="!item.value.ValueType">
                                      <mat-option *ngFor="let item1 of valueArray[item.value.ValueType]" [value]="item1">{{item1}}</mat-option>
                                    </mat-select>
                                    <mat-error *ngIf="item.get('Value').errors">
                                      <ng-container *ngIf="item.get('Value').errors.required">Value is required.
                                      </ng-container>
                                    </mat-error>
                                  </mat-form-field>
                                </div>
                              </div>
                            </div>
                            <div class="col-lg-2 col-md-2 col-4 d-flex pt-2">
                              <mat-icon class="red-color cursorPointer mr-3" [ngClass]="f1.value.length < 2 ? 'disabledIT':''" (click)="delete('responsetimereminders',i)">delete</mat-icon>
                              <i class="icon-add pt-1 primary-color" [ngClass]="form1.get('responsetimereminders').invalid ? 'disabledIT':'cursorPointer '" (click)="add(1)" *ngIf="last"></i>
                            </div>
                            </div>
                            <div class="row" [formGroupName]="i" *ngIf="item.value.Field && item.value.Condition && item.value.Value" [ngClass]="last ? '' : 'borderBottom'">
                            <div class="col-4">
                              <mat-form-field appearance="fill">
                                <mat-label> {{labelName?.Remindto}}</mat-label>
                                <mat-select formControlName="RemindTo" (selectionChange)="remindToChanged('responsetimereminders',i)">
                                  <mat-option *ngFor="let item1 of dummyJsonRemindTo" [value]="item1.Key">{{item1.Value}}</mat-option>
                                </mat-select>
                                <mat-error *ngIf="item.get('RemindTo').errors">
                                  <ng-container *ngIf="item.get('RemindTo').errors.required">Remind to is required.
                                  </ng-container>
                                </mat-error>
                              </mat-form-field>
                            </div>
                            <ng-container *ngIf="item.value.RemindTo">
                              <div class="col-4">
                                <mat-form-field appearance="fill">
                                  <mat-label>{{item.value.RemindTo == 'Others' ? 'External Notification' : 'Internal Notification'}}</mat-label>
                                  <mat-select formControlName="NotificationId">
                                    <ng-container *ngIf="item.value.RemindTo != 'Others'">
                                      <mat-option *ngFor="let item1 of internal" matTooltip="{{item1.Name}}" [value]="item1.Actionable">{{item1.Name}}</mat-option>
                                    </ng-container>
                                    <ng-container *ngIf="item.value.RemindTo == 'Others'">
                                      <mat-option *ngFor="let item1 of external" matTooltip="{{item1.Name}}" [value]="item1.Actionable">{{item1.Name}}</mat-option>
                                    </ng-container>
                                  </mat-select>
                                  <mat-error *ngIf="item.get('NotificationId').errors">
                                    <ng-container *ngIf="item.get('NotificationId').errors.required">Notification is required.
                                    </ng-container>
                                  </mat-error>
                                </mat-form-field>
                              </div>
                              <div class="col-4 example-container inputText normal-dropdown">
                                <mat-form-field appearance="fill">
                                  <input matInput type="number" (keypress)="numericOnly($event)" min="1" formControlName="IntervalValue" panelClass="normal-panel" class="example-right-align" placeholder="00">
                                  <span matPrefix> {{labelName?.Before}}</span>
                                  <mat-select matSuffix placeholder="Min"  class="ml-2" formControlName="IntervalType" (selectionChange)="timetypeChanged('responsetimereminders',i)">
                                    <mat-option *ngFor="let item of returnIntervalType('responsetimereminders',i)"  [value]="item.Key">{{item.Value}}</mat-option>
                                  </mat-select>
                                  <mat-hint class="mt-1 errorMsg" *ngIf="item.get('IntervalType').errors">
                                    <ng-container *ngIf="item.get('IntervalType').errors.required">Interval type is required.
                                    </ng-container>
                                  </mat-hint>
                                  <mat-error class="mt-1" *ngIf="item.get('IntervalValue').errors">
                                    <ng-container *ngIf="item.get('IntervalValue').errors.required">Interval value is required.
                                    </ng-container>
                                    <ng-container *ngIf="!item.get('IntervalValue').errors.required && (item.get('IntervalValue').errors.min || item.get('IntervalValue').errors.max)">Interval Value is invalid.
                                    </ng-container>
                                  </mat-error>
                                </mat-form-field>
                              </div>
                            </ng-container>
                              <!-- <div class="col-2 d-flex pt-2">
                                <mat-icon class="red-color cursorPointer mr-3" [ngClass]="f1.value.length < 2 ? 'disabledIT':''" (click)="delete('responsetimereminders',i)">delete</mat-icon>
                                <i class="icon-add pt-1 primary-color" [ngClass]="form1.get('responsetimereminders').invalid ? 'disabledIT':'cursorPointer '" (click)="add(1)" *ngIf="last"></i>
                              </div> -->
                              <div class="col-3"></div>
                              <div class="col-6" *ngIf="item.value.RemindTo == 'Others'">
                                <mat-form-field class="example-chip-list" appearance="fill">
                                  <mat-label> {{labelName?.Email}}</mat-label>
                                  <mat-chip-list #chipList aria-label="Video keywords" multiple formControlName="EmailID">
                                    <mat-chip
                                        *ngFor="let keyword of item.value.EmailID"
                                        [selected]="keyword"
                                        [value]="keyword"
                                        (removed)="removeKeyword(keyword,'responsetimereminders',i)">
                                      {{keyword}}
                                      <button matChipRemove>
                                        <mat-icon>cancel</mat-icon>
                                      </button>
                                    </mat-chip>
                                    <input
                                      placeholder="New Email..."
                                      [matChipInputFor]="chipList"
                                      (matChipInputTokenEnd)="addKeywordFromInput($event,'responsetimereminders',i)">
                                  </mat-chip-list>
                                  <mat-hint  class="errorMsg" *ngIf=" invalidemail === true">Invalid email</mat-hint>
                                  <mat-error class="mt-1" *ngIf="item.get('EmailID').errors">
                                    <ng-container *ngIf="item.get('EmailID').errors.required">{{labelName?.Email}} is required.
                                    </ng-container>
                                  </mat-error>
                                  <mat-error *ngIf="item.get('EmailID').hasError('sameEmail')" class="small-font">{{labelName?.Email}} cannot be Duplicate</mat-error>
                                </mat-form-field>
                              </div>
                          </div>
                        </div>
                      </div>
                      <!-- <div class="p-3 mb-3 backgroundWhite">
                        <div class="row mb-3">
                          <div class="col-12">
                            Resolution Time Reminders
                          </div>
                        </div>
                        <div  formArrayName="resolutiontimereminders" *ngFor="let item of form1.get('resolutiontimereminders')['controls']; let i = index; let first = first;let last = last">
                          <div class="row" [formGroupName]="i">
                            <div class="col-3">
                              <mat-form-field appearance="fill">
                                <mat-label>Remind to</mat-label>
                                <mat-select formControlName="RemindTo" (selectionChange)="remindToChanged('resolutiontimereminders',i)">
                                  <mat-option *ngFor="let item1 of dummyJsonRemindTo" [value]="item1.Key">{{item1.Value}}</mat-option>
                                </mat-select>
                                <mat-error *ngIf="item.get('RemindTo').errors">
                                  <ng-container *ngIf="item.get('RemindTo').errors.required">RemindTo is required.
                                  </ng-container>
                                </mat-error>
                              </mat-form-field>
                            </div>
                            <ng-container *ngIf="item.value.RemindTo">
                              <div class="col-3">
                                <mat-form-field appearance="fill">
                                  <mat-label>{{item.value.RemindTo == 'Others' ? 'External Notification' : 'Internal Notification'}}</mat-label>
                                  <mat-select formControlName="NotificationId">
                                    <ng-container *ngIf="item.value.RemindTo != 'Others'">
                                      <mat-option *ngFor="let item1 of internal" matTooltip="{{item1.Name}}" [value]="item1.Actionable">{{item1.Name}}</mat-option>
                                    </ng-container>
                                    <ng-container *ngIf="item.value.RemindTo == 'Others'">
                                      <mat-option *ngFor="let item1 of external" matTooltip="{{item1.Name}}" [value]="item1.Actionable">{{item1.Name}}</mat-option>
                                    </ng-container>
                                  </mat-select>
                                  <mat-error *ngIf="item.get('NotificationId').errors">
                                    <ng-container *ngIf="item.get('NotificationId').errors.required">notification is required.
                                    </ng-container>
                                  </mat-error>
                                </mat-form-field>
                              </div>
                              <div class="col-4 example-container inputText normal-dropdown">
                                <mat-form-field appearance="fill">
                                  <input matInput type="number" min="1" formControlName="IntervalValue" panelClass="normal-panel" class="example-right-align" placeholder="00">
                                  <span matPrefix>After</span>
                                  <mat-select matSuffix  class="ml-2" formControlName="IntervalType" (selectionChange)="timetypeChanged('resolutiontimereminders',i)">
                                    <mat-option value="day" selected>Day</mat-option>
                                    <mat-option value="hour">Hrs.</mat-option>
                                    <mat-option value="minute">Min.</mat-option>
                                  </mat-select>
                                  <mat-error *ngIf="item.get('IntervalValue').errors">
                                    <ng-container *ngIf="item.get('IntervalValue').errors.required">Interval value is required.
                                    </ng-container>
                                    <ng-container *ngIf="item.get('IntervalValue').errors.pattern">Interval value is invalid.
                                    </ng-container>
                                  </mat-error>
                                </mat-form-field>
                              </div>
                            </ng-container>
                              <div class="col-2 d-flex pt-2">
                                <mat-icon class="red-color cursorPointer mr-3" [ngClass]="f2.value.length < 2 ? 'disabledIT':''" (click)="delete('resolutiontimereminders',i)">delete</mat-icon>
                                <i class="icon-add pt-1 primary-color" [ngClass]="form1.get('resolutiontimereminders').invalid ? 'disabledIT':'cursorPointer '" (click)="add(2)" *ngIf="last"></i>
                              </div>
                              <div class="col-3"></div>
                              <div class="col-6" *ngIf="item.value.RemindTo == 'Others'">
                                <mat-form-field class="example-chip-list" appearance="fill">
                                  <mat-label>Email</mat-label>
                                  <mat-chip-list #chipList aria-label="Video keywords" multiple formControlName="EmailID">
                                    <mat-chip
                                        *ngFor="let keyword of item.value.EmailID"
                                        [selected]="keyword"
                                        [value]="keyword"
                                        (removed)="removeKeyword(keyword,'resolutiontimereminders',i)">
                                      {{keyword}}
                                      <button matChipRemove>
                                        <mat-icon>cancel</mat-icon>
                                      </button>
                                    </mat-chip>
                                    <input
                                      placeholder="New Email..."
                                      [matChipInputFor]="chipList"
                                      (matChipInputTokenEnd)="addKeywordFromInput($event,'resolutiontimereminders',i)">
                                  </mat-chip-list>
                                </mat-form-field>
                              </div>
                          </div>
                        </div>
                      </div> -->
                    </mat-expansion-panel>
                    <mat-expansion-panel  (opened)="!form.value.EnableEscalation ? mapanel1.close():''"
                    #mapanel1="matExpansionPanel" class="expansionPanelBorder mb-3">
                      <mat-expansion-panel-header>
                        <mat-panel-title>
                          {{labelName?.Escalations}}
                        </mat-panel-title>
                        <mat-slide-toggle (click)="$event.stopPropagation();" [(ngModel)]="escalationToggleStatus" [ngModelOptions]="{standalone: true}" color="primary" class="toggleBtn"  (toggleChange)="toggleStatusCheck(2);!form.value.EnableEscalation ? mapanel1.close() : ''"></mat-slide-toggle>
                      </mat-expansion-panel-header>
                      <div class="p-3 mb-3 backgroundWhite">
                        <div class="row mb-3">
                          <div class="col-12">
                            {{form?.value['SLAType']}}  {{labelName?.Reminders}}
                          </div>
                        </div>
                        <div  formArrayName="responsetimeescalation" *ngFor="let item of form1.get('responsetimeescalation')['controls']; let i = index; let first = first;let last = last">
                          <div class="row" [formGroupName]="i" [ngClass]="first ? '' : 'mt-3'">
                            <div class="col-lg-10 col-md-9 col-8">
                              <div class="row">
                                <div class="col-lg-3 col-md-6 col-12">
                                  <mat-form-field appearance="fill">
                                    <mat-label> {{labelName?.Field}}</mat-label>
                                    <mat-select formControlName="Field" disabled>
                                      <mat-option *ngFor="let item1 of SLAType" matTooltip="{{item1.Value}}" [value]="item1.Key">{{item1.Value}}</mat-option>
                                    </mat-select>
                                    <mat-error *ngIf="item.get('Field').errors">
                                      <ng-container *ngIf="item.get('Field').errors.required">Field is required.
                                      </ng-container>
                                    </mat-error>
                                  </mat-form-field>
                                </div>
                                <div class="col-lg-3 col-md-6 col-12">
                                  <mat-form-field appearance="fill">
                                    <mat-label> {{labelName?.Condition}}</mat-label>
                                    <mat-select formControlName="Condition">
                                      <mat-option *ngFor="let item1 of comparisonOperator" [value]="item1">{{item1}}</mat-option>
                                    </mat-select>
                                    <mat-error *ngIf="item.get('Condition').errors">
                                      <ng-container *ngIf="item.get('Condition').errors.required">Condition is required.
                                      </ng-container>
                                    </mat-error>
                                  </mat-form-field>
                                </div>
                                <div class="col-lg-3 col-md-6 col-12">
                                  <mat-form-field appearance="fill">
                                    <mat-label> {{labelName?.Type}}</mat-label>
                                    <mat-select formControlName="ValueType" (selectionChange)="conditionValueTypeChanged('responsetimeescalation',i)">
                                      <mat-option *ngFor="let item1 of valueTypeArray" [value]="item1.Key">{{item1.Value}}</mat-option>
                                    </mat-select>
                                    <mat-error *ngIf="item.get('ValueType').errors">
                                      <ng-container *ngIf="item.get('ValueType').errors.required">Type is required.
                                      </ng-container>
                                    </mat-error>
                                  </mat-form-field>
                                </div>
                                <div class="col-lg-3 col-md-6 col-12">
                                  <mat-form-field appearance="fill">
                                    <mat-label> {{labelName?.Value}}</mat-label>
                                    <mat-select formControlName="Value" (selectionChange)="conditionValueChanged('responsetimeescalation',i)" [disabled]="!item.value.ValueType">
                                      <mat-option *ngFor="let item1 of valueArray[item.value.ValueType]" [value]="item1">{{item1}}</mat-option>
                                    </mat-select>
                                    <mat-error *ngIf="item.get('Value').errors">
                                      <ng-container *ngIf="item.get('Value').errors.required">Value is required.
                                      </ng-container>
                                    </mat-error>
                                  </mat-form-field>
                                </div>
                              </div>
                            </div>
                            <div class="col-lg-2 col-md-2 col-4 d-flex pt-2">
                              <mat-icon class="red-color cursorPointer mr-3" [ngClass]="f3.value.length < 2 ? 'disabledIT':''" (click)="delete('responsetimeescalation',i)">delete</mat-icon>
                              <i class="icon-add pt-1 primary-color" [ngClass]="form1.get('responsetimeescalation').invalid ? 'disabledIT':'cursorPointer '" (click)="add(3)" *ngIf="last"></i>
                            </div>
                            </div>
                            <div class="row" [formGroupName]="i" *ngIf="item.value.Field && item.value.Condition && item.value.Value" [ngClass]="last ? '' : 'borderBottom'">
                            <div class="col-4">
                              <mat-form-field appearance="fill">
                                <mat-label> {{labelName?.Remindto}}</mat-label>
                                <mat-select formControlName="RemindTo" (selectionChange)="remindToChanged('responsetimeescalation',i)">
                                  <mat-option *ngFor="let item1 of dummyJsonRemindTo" [value]="item1.Key">{{item1.Value}}</mat-option>
                                </mat-select>
                                <mat-error *ngIf="item.get('RemindTo').errors">
                                  <ng-container *ngIf="item.get('RemindTo').errors.required">Remind to is required.
                                  </ng-container>
                                </mat-error>
                              </mat-form-field>
                            </div>
                            <ng-container *ngIf="item.value.RemindTo">
                              <div class="col-4">
                                <mat-form-field appearance="fill">
                                  <mat-label>{{item.value.RemindTo == 'Others' ? 'External Notification' : 'Internal Notification'}}</mat-label>
                                  <mat-select formControlName="NotificationId">
                                    <ng-container *ngIf="item.value.RemindTo != 'Others'">
                                      <mat-option *ngFor="let item1 of internal" matTooltip="{{item1.Name}}" [value]="item1.Actionable">{{item1.Name}}</mat-option>
                                    </ng-container>
                                    <ng-container *ngIf="item.value.RemindTo == 'Others'">
                                      <mat-option *ngFor="let item1 of external" matTooltip="{{item1.Name}}" [value]="item1.Actionable">{{item1.Name}}</mat-option>
                                    </ng-container>
                                  </mat-select>
                                  <mat-error *ngIf="item.get('NotificationId').errors">
                                    <ng-container *ngIf="item.get('NotificationId').errors.required">Notification is required.
                                    </ng-container>
                                  </mat-error>
                                </mat-form-field>
                              </div>
                              <div class="col-4 example-container inputText normal-dropdown">
                                <mat-form-field appearance="fill">
                                  <input matInput type="number" (keypress)="numericOnly($event)" min="1" formControlName="IntervalValue" panelClass="normal-panel" class="example-right-align" placeholder="00">
                                  <span matPrefix> {{labelName?.Before}}</span>
                                  <mat-select matSuffix placeholder="Min"  class="ml-2" formControlName="IntervalType" (selectionChange)="timetypeChanged('responsetimeescalation',i)">
                                    <mat-option *ngFor="let item of returnIntervalType('responsetimeescalation',i)"  [value]="item.Key">{{item.Value}}</mat-option>
                                  </mat-select>
                                  <!-- <mat-error class="mt-1" *ngIf="item.get('IntervalValue').errors">
                                      <ng-container *ngIf="item.get('IntervalValue').errors.required">Interval value is required.</ng-container>
                                    <ng-container *ngIf="!item.get('IntervalValue').errors.required && (item.get('IntervalValue').errors.min || item.get('IntervalValue').errors.max)">Interval Value is invalid.
                                    </ng-container>
                                  </mat-error> -->
                                  <mat-hint class="mt-1 errorMsg" *ngIf="item.get('IntervalType').errors ">
                                    <ng-container *ngIf="item.get('IntervalType').errors.required">Interval type is required.
                                    </ng-container>
                                  </mat-hint>
                                  <mat-error class="mt-1" *ngIf="item.get('IntervalValue').errors ">
                                    <ng-container *ngIf="item.get('IntervalValue').errors.required">Interval value is required.
                                    </ng-container>
                                    <ng-container *ngIf="!item.get('IntervalValue').errors.required && (item.get('IntervalValue').errors.min || item.get('IntervalValue').errors.max)">Interval Value is invalid.
                                    </ng-container>
                                  </mat-error>
                                </mat-form-field>
                              </div>
                            </ng-container>
                              <!-- <div class="col-2 d-flex pt-2">
                                <mat-icon class="red-color cursorPointer mr-3" [ngClass]="f1.value.length < 2 ? 'disabledIT':''" (click)="delete('responsetimeescalation',i)">delete</mat-icon>
                                <i class="icon-add pt-1 primary-color" [ngClass]="form1.get('responsetimeescalation').invalid ? 'disabledIT':'cursorPointer '" (click)="add(3)" *ngIf="last"></i>
                              </div> -->
                              <div class="col-3"></div>
                              <div class="col-6" *ngIf="item.value.RemindTo == 'Others'">
                                <mat-form-field class="example-chip-list" appearance="fill">
                                  <mat-label> {{labelName?.Email}}</mat-label>
                                  <mat-chip-list #chipList aria-label="Video keywords" multiple formControlName="EmailID">
                                    <mat-chip
                                        *ngFor="let keyword of item.value.EmailID"
                                        [selected]="keyword"
                                        [value]="keyword"
                                        (removed)="removeKeyword(keyword,'responsetimeescalation',i)">
                                      {{keyword}}
                                      <button matChipRemove>
                                        <mat-icon>cancel</mat-icon>
                                      </button>
                                    </mat-chip>
                                    <input
                                      placeholder="New Email..."
                                      [matChipInputFor]="chipList"
                                      (matChipInputTokenEnd)="addKeywordFromInput($event,'responsetimeescalation',i)">
                                  </mat-chip-list>
                                  <mat-error class="mt-1" *ngIf="item.get('EmailID').errors">
                                    <ng-container *ngIf="item.get('EmailID').errors.required">{{labelName?.Email}} is required.
                                    </ng-container>
                                  </mat-error>
                                </mat-form-field>
                              </div>
                          </div>
                        </div>
                      </div>
                      <!-- <div class="p-3 mb-3 backgroundWhite">
                        <div class="row mb-3">
                          <div class="col-12">
                            Resolution Time Reminders
                          </div>
                        </div>
                        <div  formArrayName="resolutiontimeescalation" *ngFor="let item of form1.get('resolutiontimeescalation')['controls']; let i = index; let first = first;let last = last">
                          <div class="row" [formGroupName]="i">
                            <div class="col-3">
                              <mat-form-field appearance="fill">
                                <mat-label>Remind to</mat-label>
                                <mat-select formControlName="RemindTo" (selectionChange)="remindToChanged('resolutiontimeescalation',i)">
                                  <mat-option *ngFor="let item1 of dummyJsonRemindTo" [value]="item1.Key">{{item1.Value}}</mat-option>
                                </mat-select>
                                <mat-error *ngIf="item.get('RemindTo').errors">
                                  <ng-container *ngIf="item.get('RemindTo').errors.required">RemindTo is required.
                                  </ng-container>
                                </mat-error>
                              </mat-form-field>
                            </div>
                            <ng-container *ngIf="item.value.RemindTo">
                              <div class="col-3">
                                <mat-form-field appearance="fill">
                                  <mat-label>{{item.value.RemindTo == 'Others' ? 'External Notification' : 'Internal Notification'}}</mat-label>
                                  <mat-select formControlName="NotificationId">
                                    <ng-container *ngIf="item.value.RemindTo != 'Others'">
                                      <mat-option *ngFor="let item1 of internal" matTooltip="{{item1.Name}}" [value]="item1.Actionable">{{item1.Name}}</mat-option>
                                    </ng-container>
                                    <ng-container *ngIf="item.value.RemindTo == 'Others'">
                                      <mat-option *ngFor="let item1 of external" matTooltip="{{item1.Name}}" [value]="item1.Actionable">{{item1.Name}}</mat-option>
                                    </ng-container>
                                  </mat-select>
                                  <mat-error *ngIf="item.get('NotificationId').errors">
                                    <ng-container *ngIf="item.get('NotificationId').errors.required">notification is required.
                                    </ng-container>
                                  </mat-error>
                                </mat-form-field>
                              </div>
                              <div class="col-4 example-container inputText normal-dropdown">
                                <mat-form-field appearance="fill">
                                  <input matInput type="number" min="1" formControlName="IntervalValue" panelClass="normal-panel" class="example-right-align" placeholder="00">
                                  <span matPrefix>After</span>
                                  <mat-select matSuffix  class="ml-2" formControlName="IntervalType" (selectionChange)="timetypeChanged('resolutiontimeescalation',i)">
                                    <mat-option value="day" selected>Day</mat-option>
                                    <mat-option value="hour">Hrs.</mat-option>
                                    <mat-option value="minute">Min.</mat-option>
                                  </mat-select>
                                  <mat-error *ngIf="item.get('IntervalValue').errors">
                                    <ng-container *ngIf="item.get('IntervalValue').errors.required">Interval value is required.
                                    </ng-container>
                                    <ng-container *ngIf="item.get('IntervalValue').errors.pattern">Interval value is invalid.
                                    </ng-container>
                                  </mat-error>
                                </mat-form-field>
                              </div>
                            </ng-container>
                              <div class="col-2 d-flex pt-2">
                                <mat-icon class="red-color cursorPointer mr-3" [ngClass]="f4.value.length < 2 ? 'disabledIT':''" (click)="delete('resolutiontimeescalation',i)">delete</mat-icon>
                                <i class="icon-add pt-1 primary-color" [ngClass]="form1.get('resolutiontimeescalation').invalid ? 'disabledIT':'cursorPointer '" (click)="add(4)" *ngIf="last"></i>
                              </div>
                              <div class="col-3"></div>
                              <div class="col-6" *ngIf="item.value.RemindTo == 'Others'">
                                <mat-form-field class="example-chip-list" appearance="fill">
                                  <mat-label>Email</mat-label>
                                  <mat-chip-list #chipList aria-label="Video keywords" multiple formControlName="EmailID">
                                    <mat-chip
                                        *ngFor="let keyword of item.value.EmailID"
                                        [selected]="keyword"
                                        [value]="keyword"
                                        (removed)="removeKeyword(keyword,'resolutiontimeescalation',i)">
                                      {{keyword}}
                                      <button matChipRemove>
                                        <mat-icon>cancel</mat-icon>
                                      </button>
                                    </mat-chip>
                                    <input
                                      placeholder="New Email..."
                                      [matChipInputFor]="chipList"
                                      (matChipInputTokenEnd)="addKeywordFromInput($event,'resolutiontimeescalation',i)">
                                  </mat-chip-list>
                                </mat-form-field>
                              </div>
                          </div>
                        </div>
                      </div> -->
                    </mat-expansion-panel>
                    </form>
                  </mat-accordion>
              </div>
            </div>
          </div>
          <div class="btn-group">
            <!-- <button class="btn btn-gray" (click)="back()" *ngIf="userConfig?.Cancel" mat-flat-button> {{labelName?.Cancel}}</button> -->
            <button *ngIf="!id && userConfig?.Reset" mat-flat-button  class="btn btn-gray"  (click)="reset()"> {{labelName?.Reset}}</button>
            <button *ngIf=" !id && userConfig?.SaveAddNew " class="btn outline"   mat-stroked-button color="primary" (click)="submit('saveAndAddNew')">{{labelName?.SaveAddNew}}</button>
            <button class="btn" mat-flat-button color="primary" *ngIf="id ? (userConfig?.Update) : (userConfig?.Save)" (click)="submit('save')" type="button">{{ id ? labelName?.Update : labelName?.Save  }}</button>
          </div>

      </div>
    </div>
  </div>
</div>
<!-- {{form.value|json}}:{{form1.value|json}}:{{minValue}}:{{maxValue}} -->
